<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>d9562d3498a447a58ee3ac169aa1e580</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="f3551217" class="cell markdown" id="f3551217">
<h1 id="web-server-log-analysis---python-take-home-assessment">Web
Server Log Analysis - Python Take-Home Assessment</h1>
</div>
<div id="98eb0efa" class="cell markdown" id="98eb0efa">
<h2 id="overview">Overview</h2>
<p>This assessment involves analyzing the Calgary HTTP dataset, which
contains approximately one year's worth of HTTP requests to the
University of Calgary's Computer Science web server. You'll work with
real-world web server log data to extract meaningful insights and
demonstrate your Python data analysis skills.</p>
</div>
<div id="81debeba" class="cell markdown" id="81debeba">
<h2 id="part-1-data-loading-and-cleaning">Part 1: Data Loading and
Cleaning</h2>
</div>
<div id="9e728b83" class="cell markdown" id="9e728b83">
<h3 id="instructions">Instructions</h3>
<ul>
<li>Work in the cells below - You can add as many cells as needed for
data loading, cleaning, and exploration</li>
<li>Import required libraries</li>
<li>Implement data loading and cleaning - Create functions to download,
parse, and clean the log data</li>
<li>Explore the data - Understand the structure and identify any data
quality issues</li>
</ul>
</div>
<div id="b2c05313" class="cell code" data-execution_count="16"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="b2c05313" data-outputId="adf7aee5-c1a7-4764-fb50-fb26bed52e13">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gzip</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> urllib.request</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Download the file</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">&#39;ftp://ita.ee.lbl.gov/traces/calgary_access_log.gz&#39;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">&#39;calgary_access_log.gz&#39;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>urllib.request.urlretrieve(url, filename)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Downloaded:&quot;</span>, filename)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Regex pattern for Apache Common Log Format</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>log_pattern <span class="op">=</span> re.<span class="bu">compile</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r&#39;(?P&lt;remotehost&gt;\S+) \S+ \S+ \[(?P&lt;timestamp&gt;[^\]]+)\] &#39;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r&#39;&quot;(?P&lt;request&gt;[^&quot;]+)&quot; (?P&lt;status&gt;\d</span><span class="sc">{3}</span><span class="vs">) (?P&lt;bytes&gt;\S+)&#39;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Read and parse log lines</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>log_entries <span class="op">=</span> []</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> gzip.<span class="bu">open</span>(filename, <span class="st">&#39;rt&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, errors<span class="op">=</span><span class="st">&#39;ignore&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        match <span class="op">=</span> log_pattern.match(line)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> match:</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> match.groupdict()</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Parse timestamp</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>                dt <span class="op">=</span> datetime.strptime(data[<span class="st">&#39;timestamp&#39;</span>], <span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%b/%Y:%H:%M:%S %z&#39;</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>            data[<span class="st">&#39;datetime&#39;</span>] <span class="op">=</span> dt</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Split the request line into method, file, and protocol</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>            request_parts <span class="op">=</span> data[<span class="st">&#39;request&#39;</span>].split()</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(request_parts) <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>                data[<span class="st">&#39;method&#39;</span>], data[<span class="st">&#39;file&#39;</span>], data[<span class="st">&#39;protocol&#39;</span>] <span class="op">=</span> request_parts</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                data[<span class="st">&#39;method&#39;</span>], data[<span class="st">&#39;file&#39;</span>], data[<span class="st">&#39;protocol&#39;</span>] <span class="op">=</span> <span class="st">&#39;&#39;</span>, <span class="st">&#39;&#39;</span>, <span class="st">&#39;&#39;</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Convert status to int</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>                data[<span class="st">&#39;status&#39;</span>] <span class="op">=</span> <span class="bu">int</span>(data[<span class="st">&#39;status&#39;</span>])</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                data[<span class="st">&#39;status&#39;</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Convert bytes to int, treat &#39;-&#39; as 0</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>            data[<span class="st">&#39;bytes&#39;</span>] <span class="op">=</span> <span class="bu">int</span>(data[<span class="st">&#39;bytes&#39;</span>]) <span class="cf">if</span> data[<span class="st">&#39;bytes&#39;</span>].isdigit() <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Extract file extension if any</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;.&#39;</span> <span class="kw">in</span> data[<span class="st">&#39;file&#39;</span>]:</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>                data[<span class="st">&#39;extension&#39;</span>] <span class="op">=</span> data[<span class="st">&#39;file&#39;</span>].rsplit(<span class="st">&#39;.&#39;</span>, <span class="dv">1</span>)[<span class="op">-</span><span class="dv">1</span>].lower()</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>                data[<span class="st">&#39;extension&#39;</span>] <span class="op">=</span> <span class="st">&#39;&#39;</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>            log_entries.append(data)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Load into pandas DataFrame</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(log_entries)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Preview the data</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">✅ Loaded </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss"> valid log entries.</span><span class="ch">\n</span><span class="ss">&quot;</span>)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Downloaded: calgary_access_log.gz

✅ Loaded 724836 valid log entries.

  remotehost                   timestamp                  request  status  \
0      local  24/Oct/1994:13:41:41 -0600  GET index.html HTTP/1.0     200   
1      local  24/Oct/1994:13:41:41 -0600       GET 1.gif HTTP/1.0     200   
2      local  24/Oct/1994:13:43:13 -0600  GET index.html HTTP/1.0     200   
3      local  24/Oct/1994:13:43:14 -0600       GET 2.gif HTTP/1.0     200   
4      local  24/Oct/1994:13:43:15 -0600       GET 3.gif HTTP/1.0     200   

   bytes                   datetime method        file  protocol extension  
0    150  1994-10-24 13:41:41-06:00    GET  index.html  HTTP/1.0      html  
1   1210  1994-10-24 13:41:41-06:00    GET       1.gif  HTTP/1.0       gif  
2   3185  1994-10-24 13:43:13-06:00    GET  index.html  HTTP/1.0      html  
3   2555  1994-10-24 13:43:14-06:00    GET       2.gif  HTTP/1.0       gif  
4  36403  1994-10-24 13:43:15-06:00    GET       3.gif  HTTP/1.0       gif  
</code></pre>
</div>
</div>
<div id="8e491a4e" class="cell markdown" id="8e491a4e">
<h2 id="️-important-template-questions-section">⚠️ IMPORTANT: Template
Questions Section</h2>
<p><strong>DO NOT MODIFY THE TEMPLATE BELOW THIS POINT</strong></p>
<p>The following section contains the assessment questions. You may add
cells above this section for data loading, cleaning, and exploration,
but do not modify the function signatures or structure of the questions
below.</p>
</div>
<div id="80da5c6e" class="cell markdown" id="80da5c6e">
<h2 id="part-2-analysis-questions">Part 2: Analysis Questions</h2>
</div>
<div id="38f1ce65" class="cell markdown" id="38f1ce65">
<h3 id="instructions">Instructions</h3>
<ul>
<li>Implement each function according to its docstring
specifications</li>
<li>Use the cleaned data you prepared in Part 1</li>
<li>Ensure your functions return the exact data types specified</li>
<li>Test your functions to verify they work correctly</li>
<li>You may add helper functions, but keep the main function signatures
unchanged</li>
</ul>
</div>
<div id="afff13fe" class="cell markdown" id="afff13fe"
data-vscode="{&quot;languageId&quot;:&quot;plaintext&quot;}">
<h3 id="q1-count-of-total-log-records">Q1: Count of total log
records</h3>
</div>
<div id="f6264dd7" class="cell code" data-execution_count="17"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="f6264dd7" data-outputId="88f26478-d561-457a-e19d-213d6d115910">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> total_log_records() <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Q1: Count of total log records.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Objective:</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">        Determine the total number of HTTP log entries in the dataset.</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Each line in the log file represents one HTTP request.</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">        int: Total number of log entries.</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: Implement Total number of log entries.</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">len</span>(df)  <span class="co"># Placeholder return</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>answer1 <span class="op">=</span> total_log_records()</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Answer 1:&quot;</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(answer1)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Answer 1:
724836
</code></pre>
</div>
</div>
<div id="78c5141e" class="cell markdown" id="78c5141e"
data-vscode="{&quot;languageId&quot;:&quot;plaintext&quot;}">
<h3 id="q2-count-of-unique-hosts">Q2: Count of unique hosts</h3>
</div>
<div id="fcbccae5" class="cell code" data-execution_count="18"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="fcbccae5" data-outputId="e7148334-fc16-40e3-d25e-103a854e8dea">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> unique_host_count() <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Q2: Count of unique hosts.</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Objective:</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">        Determine how many distinct hosts accessed the server.</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">        int: Number of unique hosts.</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: Implement logic to count unique hosts</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df[<span class="st">&#39;remotehost&#39;</span>].nunique()</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>answer2 <span class="op">=</span> unique_host_count()</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Answer 2:&quot;</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(answer2)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Answer 2:
2
</code></pre>
</div>
</div>
<div id="f2c224d5" class="cell markdown" id="f2c224d5"
data-vscode="{&quot;languageId&quot;:&quot;plaintext&quot;}">
<h3 id="q3-date-wise-unique-filename-counts">Q3: Date-wise unique
filename counts</h3>
</div>
<div id="ac11c680" class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ac11c680" data-outputId="71c43510-e523-4662-bc0c-8c0eb4ba2707">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> datewise_unique_filename_counts() <span class="op">-&gt;</span> <span class="bu">dict</span>[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Q3: Date-wise unique filename counts.</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Objective:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">        For each date, count the number of unique filenames that accessed the server.</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">        The date should be in &#39;dd-MMM-yyyy&#39; format (e.g., &#39;01-Jul-1995&#39;).</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">        dict: A dictionary mapping each date to its count of unique filenames.</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">              Example: {&#39;01-Jul-1995&#39;: 123, &#39;02-Jul-1995&#39;: 150}</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: Implement logic for date-wise unique filename counts</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&#39;datetime&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;datetime&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&#39;date_str&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;datetime&#39;</span>].dt.strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">-%b-%Y&#39;</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df.groupby(<span class="st">&#39;date_str&#39;</span>)[<span class="st">&#39;file&#39;</span>].nunique().to_dict()</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>answer3 <span class="op">=</span> datewise_unique_filename_counts()</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Answer 3:&quot;</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(answer3)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Answer 3:
{&#39;01-Aug-1995&#39;: 670, &#39;01-Jul-1995&#39;: 388, &#39;01-Jun-1995&#39;: 591, &#39;01-May-1995&#39;: 467, &#39;01-Oct-1995&#39;: 553, &#39;01-Sep-1995&#39;: 329, &#39;02-Apr-1995&#39;: 439, &#39;02-Aug-1995&#39;: 856, &#39;02-Jul-1995&#39;: 398, &#39;02-Jun-1995&#39;: 514, &#39;02-May-1995&#39;: 702, &#39;02-Oct-1995&#39;: 872, &#39;02-Sep-1995&#39;: 350, &#39;03-Apr-1995&#39;: 796, &#39;03-Aug-1995&#39;: 583, &#39;03-Jul-1995&#39;: 434, &#39;03-Jun-1995&#39;: 399, &#39;03-May-1995&#39;: 590, &#39;03-Oct-1995&#39;: 847, &#39;03-Sep-1995&#39;: 213, &#39;04-Apr-1995&#39;: 822, &#39;04-Aug-1995&#39;: 716, &#39;04-Jul-1995&#39;: 611, &#39;04-Jun-1995&#39;: 354, &#39;04-May-1995&#39;: 685, &#39;04-Oct-1995&#39;: 890, &#39;04-Sep-1995&#39;: 341, &#39;05-Apr-1995&#39;: 891, &#39;05-Aug-1995&#39;: 508, &#39;05-Jul-1995&#39;: 608, &#39;05-Jun-1995&#39;: 495, &#39;05-May-1995&#39;: 609, &#39;05-Oct-1995&#39;: 847, &#39;05-Sep-1995&#39;: 412, &#39;06-Apr-1995&#39;: 679, &#39;06-Aug-1995&#39;: 449, &#39;06-Jul-1995&#39;: 523, &#39;06-Jun-1995&#39;: 663, &#39;06-May-1995&#39;: 517, &#39;06-Oct-1995&#39;: 869, &#39;06-Sep-1995&#39;: 550, &#39;07-Apr-1995&#39;: 777, &#39;07-Aug-1995&#39;: 609, &#39;07-Jul-1995&#39;: 428, &#39;07-Jun-1995&#39;: 486, &#39;07-May-1995&#39;: 726, &#39;07-Oct-1995&#39;: 468, &#39;07-Sep-1995&#39;: 591, &#39;08-Apr-1995&#39;: 543, &#39;08-Aug-1995&#39;: 655, &#39;08-Jul-1995&#39;: 277, &#39;08-Jun-1995&#39;: 643, &#39;08-May-1995&#39;: 657, &#39;08-Oct-1995&#39;: 515, &#39;08-Sep-1995&#39;: 755, &#39;09-Apr-1995&#39;: 627, &#39;09-Aug-1995&#39;: 699, &#39;09-Jul-1995&#39;: 233, &#39;09-Jun-1995&#39;: 468, &#39;09-May-1995&#39;: 775, &#39;09-Oct-1995&#39;: 743, &#39;09-Sep-1995&#39;: 409, &#39;10-Apr-1995&#39;: 751, &#39;10-Aug-1995&#39;: 636, &#39;10-Jul-1995&#39;: 503, &#39;10-Jun-1995&#39;: 328, &#39;10-May-1995&#39;: 795, &#39;10-Oct-1995&#39;: 842, &#39;10-Sep-1995&#39;: 456, &#39;11-Apr-1995&#39;: 817, &#39;11-Aug-1995&#39;: 452, &#39;11-Jul-1995&#39;: 572, &#39;11-Jun-1995&#39;: 298, &#39;11-May-1995&#39;: 600, &#39;11-Oct-1995&#39;: 718, &#39;11-Sep-1995&#39;: 718, &#39;12-Apr-1995&#39;: 888, &#39;12-Aug-1995&#39;: 341, &#39;12-Jul-1995&#39;: 468, &#39;12-Jun-1995&#39;: 520, &#39;12-May-1995&#39;: 469, &#39;12-Sep-1995&#39;: 719, &#39;13-Apr-1995&#39;: 614, &#39;13-Aug-1995&#39;: 464, &#39;13-Jul-1995&#39;: 500, &#39;13-Jun-1995&#39;: 466, &#39;13-May-1995&#39;: 289, &#39;13-Sep-1995&#39;: 774, &#39;14-Apr-1995&#39;: 354, &#39;14-Aug-1995&#39;: 590, &#39;14-Jul-1995&#39;: 552, &#39;14-Jun-1995&#39;: 590, &#39;14-May-1995&#39;: 326, &#39;14-Sep-1995&#39;: 719, &#39;15-Apr-1995&#39;: 419, &#39;15-Aug-1995&#39;: 482, &#39;15-Jul-1995&#39;: 385, &#39;15-Jun-1995&#39;: 480, &#39;15-May-1995&#39;: 584, &#39;15-Sep-1995&#39;: 710, &#39;16-Apr-1995&#39;: 435, &#39;16-Aug-1995&#39;: 602, &#39;16-Jul-1995&#39;: 300, &#39;16-Jun-1995&#39;: 530, &#39;16-May-1995&#39;: 432, &#39;16-Sep-1995&#39;: 565, &#39;17-Apr-1995&#39;: 446, &#39;17-Aug-1995&#39;: 538, &#39;17-Jul-1995&#39;: 568, &#39;17-Jun-1995&#39;: 384, &#39;17-May-1995&#39;: 509, &#39;17-Sep-1995&#39;: 467, &#39;18-Apr-1995&#39;: 453, &#39;18-Aug-1995&#39;: 493, &#39;18-Jul-1995&#39;: 558, &#39;18-Jun-1995&#39;: 359, &#39;18-May-1995&#39;: 529, &#39;18-Sep-1995&#39;: 658, &#39;19-Apr-1995&#39;: 701, &#39;19-Aug-1995&#39;: 378, &#39;19-Jul-1995&#39;: 472, &#39;19-Jun-1995&#39;: 613, &#39;19-May-1995&#39;: 499, &#39;19-Sep-1995&#39;: 736, &#39;20-Apr-1995&#39;: 588, &#39;20-Aug-1995&#39;: 396, &#39;20-Jul-1995&#39;: 570, &#39;20-Jun-1995&#39;: 531, &#39;20-May-1995&#39;: 254, &#39;20-Sep-1995&#39;: 833, &#39;21-Apr-1995&#39;: 713, &#39;21-Aug-1995&#39;: 632, &#39;21-Jul-1995&#39;: 650, &#39;21-Jun-1995&#39;: 625, &#39;21-May-1995&#39;: 289, &#39;21-Sep-1995&#39;: 801, &#39;22-Apr-1995&#39;: 435, &#39;22-Aug-1995&#39;: 539, &#39;22-Jul-1995&#39;: 445, &#39;22-Jun-1995&#39;: 631, &#39;22-May-1995&#39;: 478, &#39;22-Sep-1995&#39;: 616, &#39;23-Apr-1995&#39;: 333, &#39;23-Aug-1995&#39;: 661, &#39;23-Jul-1995&#39;: 499, &#39;23-Jun-1995&#39;: 562, &#39;23-May-1995&#39;: 566, &#39;23-Sep-1995&#39;: 503, &#39;24-Apr-1995&#39;: 529, &#39;24-Aug-1995&#39;: 579, &#39;24-Jul-1995&#39;: 566, &#39;24-Jun-1995&#39;: 397, &#39;24-May-1995&#39;: 490, &#39;24-Oct-1994&#39;: 229, &#39;24-Sep-1995&#39;: 594, &#39;25-Apr-1995&#39;: 558, &#39;25-Aug-1995&#39;: 596, &#39;25-Jul-1995&#39;: 589, &#39;25-Jun-1995&#39;: 570, &#39;25-May-1995&#39;: 488, &#39;25-Oct-1994&#39;: 319, &#39;25-Sep-1995&#39;: 724, &#39;26-Apr-1995&#39;: 648, &#39;26-Aug-1995&#39;: 395, &#39;26-Jul-1995&#39;: 599, &#39;26-Jun-1995&#39;: 638, &#39;26-May-1995&#39;: 425, &#39;26-Oct-1994&#39;: 377, &#39;26-Sep-1995&#39;: 871, &#39;27-Apr-1995&#39;: 616, &#39;27-Aug-1995&#39;: 437, &#39;27-Jul-1995&#39;: 615, &#39;27-Jun-1995&#39;: 518, &#39;27-May-1995&#39;: 245, &#39;27-Oct-1994&#39;: 385, &#39;27-Sep-1995&#39;: 827, &#39;28-Apr-1995&#39;: 637, &#39;28-Aug-1995&#39;: 549, &#39;28-Jul-1995&#39;: 565, &#39;28-Jun-1995&#39;: 573, &#39;28-May-1995&#39;: 205, &#39;28-Oct-1994&#39;: 400, &#39;28-Sep-1995&#39;: 868, &#39;29-Apr-1995&#39;: 449, &#39;29-Aug-1995&#39;: 512, &#39;29-Jul-1995&#39;: 321, &#39;29-Jun-1995&#39;: 470, &#39;29-May-1995&#39;: 465, &#39;29-Oct-1994&#39;: 255, &#39;29-Sep-1995&#39;: 839, &#39;30-Apr-1995&#39;: 278, &#39;30-Aug-1995&#39;: 594, &#39;30-Jul-1995&#39;: 482, &#39;30-Jun-1995&#39;: 461, &#39;30-May-1995&#39;: 554, &#39;30-Oct-1994&#39;: 20, &#39;30-Sep-1995&#39;: 651, &#39;31-Aug-1995&#39;: 510, &#39;31-Jul-1995&#39;: 623, &#39;31-May-1995&#39;: 572}
</code></pre>
</div>
</div>
<div id="4d2da36a" class="cell markdown" id="4d2da36a">
<h3 id="q4-number-of-404-response-codes">Q4: Number of 404 response
codes</h3>
</div>
<div id="d0671865" class="cell code" data-execution_count="20"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="d0671865" data-outputId="7756d68c-8d8e-4f17-9a11-84969ebd2792">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_404_errors() <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Q4: Number of 404 response codes.</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Objective:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">        Count how many times the HTTP 404 Not Found status appears in the logs.</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">        int: Number of 404 errors.</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: Implement logic to count 404 errors</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df[df[<span class="st">&#39;status&#39;</span>] <span class="op">==</span> <span class="dv">404</span>].shape[<span class="dv">0</span>]</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>answer4 <span class="op">=</span> count_404_errors()</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Answer 4:&quot;</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(answer4)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Answer 4:
23517
</code></pre>
</div>
</div>
<div id="c73928d2" class="cell markdown" id="c73928d2">
<h3 id="q5-top-15-filenames-with-404-responses">Q5: Top 15 filenames
with 404 responses</h3>
</div>
<div id="358f0523" class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="358f0523" data-outputId="c927de58-5556-48fd-bdc0-e579b7647194">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> top_15_filenames_with_404() <span class="op">-&gt;</span> <span class="bu">list</span>[<span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Q5: Top 15 filenames with 404 responses.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Objective:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">        Identify which requested URLs most frequently resulted in a 404 error.</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Return the top 15 filenames sorted by frequency.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">        list: A list of tuples (filename, count), sorted by count in descending order.</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">              Example: [(&#39;index.html&#39;, 200), ...]</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: Implement logic to find top 15 filenames with 404</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    errors_404 <span class="op">=</span> df[df[<span class="st">&#39;status&#39;</span>] <span class="op">==</span> <span class="dv">404</span>]</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    top_files <span class="op">=</span> errors_404[<span class="st">&#39;file&#39;</span>].value_counts().head(<span class="dv">15</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(top_files.items())</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>answer5 <span class="op">=</span> top_15_filenames_with_404()</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Answer 5:&quot;</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(answer5)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Answer 5:
[(&#39;index.html&#39;, 4694), (&#39;4115.html&#39;, 902), (&#39;1611.html&#39;, 649), (&#39;5698.xbm&#39;, 585), (&#39;710.txt&#39;, 408), (&#39;2002.html&#39;, 258), (&#39;2177.gif&#39;, 193), (&#39;10695.ps&#39;, 161), (&#39;6555.html&#39;, 153), (&#39;487.gif&#39;, 152), (&#39;151.html&#39;, 149), (&#39;488.gif&#39;, 148), (&#39;3414.gif&#39;, 148), (&#39;40.html&#39;, 148), (&#39;9678.gif&#39;, 142)]
</code></pre>
</div>
</div>
<div id="6328c88a" class="cell markdown" id="6328c88a">
<h3 id="q6-top-15-file-extension-with-404-responses">Q6: Top 15 file
extension with 404 responses</h3>
</div>
<div id="d0aca8cc" class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="d0aca8cc" data-outputId="294019e6-94b3-4b14-8f29-e56e240b8c59">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> top_15_ext_with_404() <span class="op">-&gt;</span> <span class="bu">list</span>[<span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Q6: Top 15 file extensions with 404 responses.</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Objective:</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">        Find which file extensions generated the most 404 errors.</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Return the top 15 sorted by number of 404s.</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">        list: A list of tuples (extension, count), sorted by count in descending order.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">              Example: [(&#39;html&#39;, 45), ...]</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: Implement logic to find top 15 extensions with 404</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    errors_404 <span class="op">=</span> df[df[<span class="st">&#39;status&#39;</span>] <span class="op">==</span> <span class="dv">404</span>]</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    top_exts <span class="op">=</span> errors_404[<span class="st">&#39;extension&#39;</span>].value_counts().head(<span class="dv">15</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(top_exts.items())</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>answer6 <span class="op">=</span> top_15_ext_with_404()</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Answer 6:&quot;</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(answer6)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Answer 6:
[(&#39;html&#39;, 12145), (&#39;gif&#39;, 7337), (&#39;xbm&#39;, 824), (&#39;ps&#39;, 754), (&#39;jpg&#39;, 531), (&#39;txt&#39;, 508), (&#39;&#39;, 163), (&#39;htm&#39;, 108), (&#39;cgi&#39;, 77), (&#39;com&#39;, 45), (&#39;z&#39;, 41), (&#39;dvi&#39;, 40), (&#39;com/&#39;, 37), (&#39;ca&#39;, 36), (&#39;hmtl&#39;, 30)]
</code></pre>
</div>
</div>
<div id="ff52c8ba" class="cell markdown" id="ff52c8ba">
<h3
id="q7-total-bandwidth-transferred-per-day-for-the-month-of-july-1995">Q7:
Total bandwidth transferred per day for the month of July 1995</h3>
</div>
<div id="45f52d9b" class="cell code" data-execution_count="23"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="45f52d9b" data-outputId="e253f900-a646-49fd-d515-7925e083ffb6">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> total_bandwidth_per_day() <span class="op">-&gt;</span> <span class="bu">dict</span>[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Q7: Total bandwidth transferred per day for the month of July 1995.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Objective:</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">        Sum the number of bytes transferred per day.</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Skip entries where the byte field is missing or &#39;-&#39;.</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">        dict: A dictionary mapping each date to total bytes transferred.</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">              Example: {&#39;01-Jul-1995&#39;: 123456789, ...}</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: Implement logic to compute total bandwidth per day</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ensure datetime column is in datetime format</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&#39;datetime&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;datetime&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter for July 1995</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    july_df <span class="op">=</span> df[(df[<span class="st">&#39;datetime&#39;</span>].dt.month <span class="op">==</span> <span class="dv">7</span>) <span class="op">&amp;</span> (df[<span class="st">&#39;datetime&#39;</span>].dt.year <span class="op">==</span> <span class="dv">1995</span>)]</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format date and sum bytes</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    july_df[<span class="st">&#39;date_str&#39;</span>] <span class="op">=</span> july_df[<span class="st">&#39;datetime&#39;</span>].dt.strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">-%b-%Y&#39;</span>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> july_df.groupby(<span class="st">&#39;date_str&#39;</span>)[<span class="st">&#39;bytes&#39;</span>].<span class="bu">sum</span>().to_dict()</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>answer7 <span class="op">=</span> total_bandwidth_per_day()</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Answer 7:&quot;</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(answer7)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Answer 7:
{&#39;01-Jul-1995&#39;: 11349799, &#39;02-Jul-1995&#39;: 8656918, &#39;03-Jul-1995&#39;: 13596612, &#39;04-Jul-1995&#39;: 26573988, &#39;05-Jul-1995&#39;: 19541225, &#39;06-Jul-1995&#39;: 19755015, &#39;07-Jul-1995&#39;: 9427822, &#39;08-Jul-1995&#39;: 5403491, &#39;09-Jul-1995&#39;: 4660556, &#39;10-Jul-1995&#39;: 14917754, &#39;11-Jul-1995&#39;: 22507207, &#39;12-Jul-1995&#39;: 17367065, &#39;13-Jul-1995&#39;: 15989234, &#39;14-Jul-1995&#39;: 19186430, &#39;15-Jul-1995&#39;: 15773233, &#39;16-Jul-1995&#39;: 9016378, &#39;17-Jul-1995&#39;: 19601338, &#39;18-Jul-1995&#39;: 17099761, &#39;19-Jul-1995&#39;: 17851725, &#39;20-Jul-1995&#39;: 20752623, &#39;21-Jul-1995&#39;: 25491617, &#39;22-Jul-1995&#39;: 8136259, &#39;23-Jul-1995&#39;: 9593870, &#39;24-Jul-1995&#39;: 22308265, &#39;25-Jul-1995&#39;: 24561635, &#39;26-Jul-1995&#39;: 24995540, &#39;27-Jul-1995&#39;: 25969995, &#39;28-Jul-1995&#39;: 36460693, &#39;29-Jul-1995&#39;: 11700624, &#39;30-Jul-1995&#39;: 23189598, &#39;31-Jul-1995&#39;: 30730715}
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>&lt;ipython-input-23-279b1ca0eabd&gt;:23: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  july_df[&#39;date_str&#39;] = july_df[&#39;datetime&#39;].dt.strftime(&#39;%d-%b-%Y&#39;)
</code></pre>
</div>
</div>
<div id="7dc00908" class="cell markdown" id="7dc00908">
<h3 id="q8-hourly-request-distribution">Q8: Hourly request
distribution</h3>
</div>
<div id="a77f3e12" class="cell code" data-execution_count="24"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="a77f3e12" data-outputId="1ce5c207-03c6-44ce-a324-42b82a5f0fde">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hourly_request_distribution() <span class="op">-&gt;</span> <span class="bu">dict</span>[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Q8: Hourly request distribution.</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Objective:</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">        Count the number of requests made during each hour (00 to 23).</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Useful for understanding traffic peaks.</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">        dict: A dictionary mapping hour (int) to request count.</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">              Example: {0: 120, 1: 90, ..., 23: 80}</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: Implement logic for hourly distribution</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&#39;datetime&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;datetime&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&#39;hour&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;datetime&#39;</span>].dt.hour</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df[<span class="st">&#39;hour&#39;</span>].value_counts().sort_index().to_dict()</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>answer8 <span class="op">=</span> hourly_request_distribution()</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Answer 8:&quot;</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(answer8)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Answer 8:
{0.0: 11598, 1.0: 9913, 2.0: 9403, 3.0: 8147, 4.0: 7820, 5.0: 8283, 6.0: 9798, 7.0: 11930, 8.0: 17351, 9.0: 21681, 10.0: 25713, 11.0: 28665, 12.0: 26845, 13.0: 30089, 14.0: 29792, 15.0: 28149, 16.0: 28286, 17.0: 23312, 18.0: 17862, 19.0: 17325, 20.0: 17488, 21.0: 15965, 22.0: 14587, 23.0: 13613}
</code></pre>
</div>
</div>
<div id="363b7083" class="cell markdown" id="363b7083">
<h3 id="q9-top-10-most-requested-filenames">Q9: Top 10 most requested
filenames</h3>
</div>
<div id="91168ad7" class="cell code" data-execution_count="25"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="91168ad7" data-outputId="3a6f1702-bb2e-4fb6-c126-f6fd250c71e9">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> top_10_most_requested_filenames() <span class="op">-&gt;</span> <span class="bu">list</span>[<span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Q9: Top 10 most requested filenames.</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Objective:</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">        Identify the most commonly requested URLs (irrespective of status code).</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">        list: A list of tuples (filename, count), sorted by count in descending order.</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">                Example: [(&#39;index.html&#39;, 500), ...]</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: Implement logic to find top 10 most requested filenames</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    top_files <span class="op">=</span> df[<span class="st">&#39;file&#39;</span>].value_counts().head(<span class="dv">10</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(top_files.items())</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>answer9 <span class="op">=</span> top_10_most_requested_filenames()</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Answer 9:&quot;</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(answer9)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Answer 9:
[(&#39;index.html&#39;, 139528), (&#39;3.gif&#39;, 24006), (&#39;2.gif&#39;, 23595), (&#39;4.gif&#39;, 8018), (&#39;244.gif&#39;, 5148), (&#39;5.html&#39;, 5010), (&#39;4097.gif&#39;, 4874), (&#39;8870.jpg&#39;, 4492), (&#39;6733.gif&#39;, 4278), (&#39;8472.gif&#39;, 3843)]
</code></pre>
</div>
</div>
<div id="eedb4778" class="cell markdown" id="eedb4778">
<h3 id="q10-http-response-code-distribution">Q10: HTTP response code
distribution</h3>
</div>
<div id="bd4453ed" class="cell code" data-execution_count="26"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="bd4453ed" data-outputId="82587645-e058-49e0-a7d6-3633e3a04624">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> response_code_distribution() <span class="op">-&gt;</span> <span class="bu">dict</span>[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Q10: HTTP response code distribution.</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Objective:</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">        Count how often each HTTP status code appears in the logs.</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">        dict: A dictionary mapping HTTP status codes (as int) to their frequency.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">              Example: {200: 150000, 404: 3000}</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: Implement logic for response code counts</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df[<span class="st">&#39;status&#39;</span>].value_counts().sort_index().to_dict()</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>answer10 <span class="op">=</span> response_code_distribution()</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Answer 10:&quot;</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(answer10)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Answer 10:
{200: 568345, 302: 30295, 304: 97792, 400: 15, 401: 46, 403: 4741, 404: 23517, 500: 42, 501: 43}
</code></pre>
</div>
</div>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"949d97ffaff28ee8","version":"2025.5.0","r":1,"token":"0357a45f23a943f08700f7f9af191ee6","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}}}' crossorigin="anonymous"></script>
</body>
</html>
